# Story 2.3: Filters (Decision, Date Range)

**Epic**: Epic 2 - Dashboard Action-First Experience  
**Story Points**: 3  
**Status**: Draft

---

## Story

**As a** merchant,  
**I want** to filter detections by decision type or date,  
**so that** I can focus on specific subsets.

---

## Acceptance Criteria

1. **AC1**: Filter 1: Decision (Shadcn `Select`) - Options: All, BLOCK, REVIEW, ALLOW
2. **AC2**: Filter 2: Date range (Shadcn `Calendar`) - Presets: Today, Last 7 days, Last 30 days, Custom
3. **AC3**: API: `GET /api/detections?decision=BLOCK&dateFrom=2026-01-01&dateTo=2026-01-12`
4. **AC4**: UI update: Feed refreshes on filter change
5. **AC5**: Reset button: Clear all filters â†’ Show all detections
6. **AC6**: URL state: Filters reflected in query params (shareable links)
7. **AC7**: Performance: Filters applied server-side (DB query), not client-side

---

## Tasks / Subtasks

- [ ] Create FiltersBar component (Select + Calendar) (AC1, AC2)
- [ ] Decision filter: Select component (All/BLOCK/REVIEW/ALLOW) (AC1)
- [ ] Date range filter: Calendar with presets (AC2)
- [ ] Reset button to clear filters (AC5)
- [ ] Update API route to accept filter params (AC3, AC7)
- [ ] Sync filters with URL query params (useSearchParams) (AC6)
- [ ] Refresh feed on filter change (AC4)

---

## Dev Notes

**Shadcn Components**: Select, Calendar, Button

**URL State**:
```
/dashboard?decision=BLOCK&dateFrom=2026-01-01
```

**API Query**:
```sql
SELECT * FROM fraud_detections
WHERE decision = 'BLOCK'
  AND created_at >= '2026-01-01'
  AND created_at < '2026-01-13'
ORDER BY created_at DESC
LIMIT 20
```

---

## Testing

- Unit: Filter state management
- E2E: Apply filters, verify results

---

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-13 | 1.0 | Story created | Sarah (PO) |
